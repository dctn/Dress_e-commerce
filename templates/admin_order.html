    {% extends 'base.html' %}

{% block head %}
<style>
/* Container */
.order-container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 15px;
}

/* Card */
.order-card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin-bottom: 25px;
    transition: transform 0.2s;
}
.order-card:hover {
    transform: translateY(-3px);
}

/* Header */
.order-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}
.order-header h3 {
    margin: 0;
    font-size: 1.2rem;
    color: #333;
}
.order-header p {
    margin: 2px 0;
    color: #555;
    font-size: 0.9rem;
}

/* Status badges */
.status-box {
    padding: 8px 15px;
    border-radius: 20px;
    color: #fff;
    font-weight: bold;
    font-size: 0.9rem;
    text-align: center;
}
.status-box.pending { background: #f0ad4e; }   /* Orange */
.status-box.packed { background: #5cb85c; }    /* Green */
.status-box.shipped { background: #0275d8; }   /* Blue */
.status-box.delivered { background: #6c757d; } /* Gray */

/* Table */
.order-items table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
}
.order-items th, .order-items td {
    padding: 12px 10px;
    border-bottom: 1px solid #eee;
    text-align: left;
}
.order-items th {
    background: #f7f7f7;
    font-weight: bold;
}

/* Footer */
.order-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
}
.order-footer p {
    font-size: 1rem;
    font-weight: bold;
    margin: 0 0 10px 0;
}

/* Button */
.btn-status {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 6px;
    font-size: 0.95rem;
    cursor: pointer;
    transition: background 0.2s;
}
.btn-status:hover {
    background-color: #0056b3;
}
.btn-status:disabled {
    background-color: #6c757d;
    cursor: not-allowed;
}

/* Responsive */
@media (max-width: 768px) {
    .order-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
    }
    .order-footer {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }
}
.filter-btn {
    background-color: #f7f7f7;
    border: 1px solid #ccc;
    padding: 8px 15px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
}
.filter-btn:hover {
    background-color: #007bff;
    color: white;
}
.filter-btn.active {
    background-color: #007bff;
    color: white;
    border-color: #007bff;
}

</style>
{% endblock %}

{% block body %}
<h1 style="text-align:center; margin-bottom:30px;">Admin Order Management</h1>
<div class="filter-container">
    <form method="get" style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:20px; justify-content:center;">
        <button type="submit" name="status" value="" class="filter-btn {% if not status_filter %}active{% endif %}">All</button>
        <button type="submit" name="status" value="pending" class="filter-btn {% if status_filter == 'pending' %}active{% endif %}">Pending</button>
        <button type="submit" name="status" value="packed" class="filter-btn {% if status_filter == 'packed' %}active{% endif %}">Packed</button>
        <button type="submit" name="status" value="shipped" class="filter-btn {% if status_filter == 'shipped' %}active{% endif %}">Shipped</button>
        <button type="submit" name="status" value="delivered" class="filter-btn {% if status_filter == 'delivered' %}active{% endif %}">Delivered</button>
    </form>
</div>

<div class="order-container">
    {% for order in orders %}
    <div class="order-card">
        <!-- Order Header -->
        <div class="order-header">
            <div>
                <h3>Order #{{ order.razorpay_order_id }}</h3>
                <p><strong>User:</strong> {{ order.user.username }}</p>
                <p><strong>Created:</strong> {{ order.created_at|date:"d M Y, H:i" }}</p>
            </div>
           <span class="status-box
    {% if order.status == 'pending' %}pending
    {% elif order.status == 'packed' %}packed
    {% elif order.status == 'shipped' %}shipped
    {% elif order.status == 'delivered' %}delivered
    {% endif %}">
    {{ order.status|capfirst }}
</span>

        </div>

        <!-- Order Items Table -->
        <div class="order-items">
            <table>
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Qty</th>
                        <th>Color</th>
                        <th>Size</th>
                        <th>Is Stitched</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order.orderitem_set.all %}
                    <tr>
                        <td>{{ item.product_name }}</td>
                        <td>{{ item.quantity }}</td>
                        <th>{{ item.color }}</th>
                        <th>{{ item.size }}</th>
                        <th>{{ item.is_stitched }}</th>
                        <td>₹{{ item.price_at_purchase }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Footer -->
        <div class="order-footer">
            <p><strong>Total:</strong> ₹{{ order.total }}</p>
            <form method="POST" action="{% url 'update_order_status' order.order_id %}">
                {% csrf_token %}
                {% if order.status != 'delivered' %}
                    <button type="submit" class="btn-status">Move to Next Stage</button>
                {% else %}
                    <button type="button" class="btn-status" disabled>Delivered</button>
                {% endif %}
            </form>
        </div>
    </div>
    {% endfor %}
</div>



    {% if not orders %}
        <h3 style="text-align:center; margin-bottom:30px;">NO Orders present</h3>

    {% endif %}
{% endblock %}
